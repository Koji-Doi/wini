# anchor() -- ハイパーリンク・画像リンクの処理

# cit() --

# cittxt() -- 

## usage

## synopsis

# citlist() --

# date() --

# deref() -- 「自動連番」の解決

## synopsis

「自動連番」を実現するために不可欠な関数である。

markgaab()は、図番号・表番号・文献番号などを仮形式の文字列として出力に埋め込んでいく。
deref()はその処理の後に呼び出され、それぞれの仮文字列を適切な番号を含む正式な文字列に置き換えていく。

# ev() --

# init() -- グローバル変数を初期化する

## usage
 
 init();

## synopsis

Wini.pmでは関数間で設定などを共有するために幾つかのグローバル変数を利用している。init()はその内部でそのようなグローバル変数の値を適切に初期化する。
また、デバッグの便宜を図るためData::Dumperの設定を書き換えている。
さらに、標準入出力およびエラー出力をutf-8ベースで行うようにbinmodeを設定する。
さらに、DATA節からメッセージ用の文字列を読み込む。

Wini.pmにテキスト変換をさせる場合は、あらゆる処理に先立って本関数を実行することが推奨される。

# list() -- markgaabの箇条書き部分をHTMLテキストに変換する

## usage

 list($mgtxt, $cr, $ptype, $para, $myclass);

 $mgtxt: markaabで書かれたテキスト
 $cr: 改行文字
 $ptype: 段落タイプ。未定義、`header`、`list`のいずれか。
 $para:  改行タイプ。未定義、`br`、`nb`のいずれか。

## synopsis

markgaabでは行頭が`*`,`#`,`:`であるような行は表（テーブル）を表現していると見なされる。markgaab()はそのような行の塊を切り出してtable()に送り、HTML tableに変換する。

# markgaab() -- markgaabテキストのHTMLテキストへの変換（下請け）

## usage

 $r = markgaab($mgtxt, $opt);

 $mgtxt: markgaabで書かれたテキスト
 $opt: オプションパラメータが記録されたハッシュのリファレンス
  $opt->{cssfile}: "<ref>"attributeに記載されるCSSファイル名
  $opt->{nocr}: 改行コードを挿入しない
  $opt->{para}: 
  $opt->{title}: ページタイトル 
  $opt->{table}: table ID
 $r: HTMLテキスト

## synopsis

* to_html()の下請けとして、markaabからHTMLへの変換を担う。
* 引用部分のリファレンス化、上付け文字・下付け文字・リンク・インラインイメージなどの処理には本関数が直接的に関与する。
* マクロが検出されたらcall_macro()を呼び出し、その中身をHTMLに変換する。
* 必要に応じてtable()およびfootnote()を呼び出し、表データを&lt;table&gt;&lt;/table&gt;を使ったHTMLに変換する。

# ref_txt() --

# ref_tmp_txt() --

# stand_alone() -- CLIコマンドとしてのWini.pmの機能を実現する

## synopsis

Wini.pmがモジュールとしてではなく単体のスクリプトとして使われ、コマンドラインツールとして使われる際、当関数が使用される。
当該関数はコマンドラインオプションを読み取り、適切なパラメータを設定した上でto_html()関数を呼び出す。
また、文献データファイルの読み書きが要求される場合はread_bib(), save_bib()関数を呼び出す。

# table() -- 表データのhtmlテキストへの変換

## usage

 table($mgtext, {lang=>'en'});

## synopsis

markgaabでは行頭が`|`であるような行は表（テーブル）を表現していると見なされる。markgaab()はそのような行の塊を切り出してtable()に送り、HTML tableに変換する。

# to_html() -- markgaabテキストのhtmlテキストへの変換（元締め）

## usage

 $r = to_html($mgtxt, $opt);

 $mgtxt: markgaabで書かれたテキスト
 $opt: オプションパラメータが記録されたハッシュのリファレンス
 $r: HTMLテキスト

## synopsis

markgaabテキストのhtmlテキストへの変換には、原則として当関数を利用する。
内部では次のような処理が実行される。

* 受け取ったmarkgaabテキストをセクションに分解する。
* セクションごとにmarkgaab()を呼び出してHTML変換。
* テンプレートが指定されている場合は、生成したテキストを指定テンプレートに埋め込み、HTMLドキュメントを完成させる。
* 自動連番を伴うテキストではderef()を呼び出し、図番号・表番号・文献番号などを確定させる。
* 必要ならwhole_html()を呼び出して自己完結型HTMLを生成。

# winifiles() -- 入力元となるファイル・出力されるファイルの列挙

## usage

 ($infiles, $outdir, $outfiles, $cssfiles) = winifiles($in, $out, $css);


# whole_html() -- ヘッダ等を付加し、自己完結したHTMLドキュメントを生成する。

## usage

 $matured_html = whole_html($raw_html, $opt);

 $raw_html: html text (probably generated by markgaab()) 
 $opt->{title}: page title
 $opt->{cssfile}: css file name used for '<link rel="stylesheet"' attribute 
 $opt->{cssflameworks}: url of css used for '<link rel="stylesheet"' attribute 

## synopsis

markgaab()が生成するHTMLドキュメントは入力元markgaabテキストを過不足なくHTMLに置き換えたものである。
出力結果は他のテキストと組み合わせて利用される前提であり、DOCTYPE宣言もHTMLタグも伴っていない。そのままではブラウザでの閲覧に問題が生じる可能性がある。当関数を利用することにより、自己完結したHTMLドキュメントが生成できる。

# ylml() --